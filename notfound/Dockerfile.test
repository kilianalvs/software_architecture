# notfound/Dockerfile.test - JAVA 21 GARANTI
FROM eclipse-temurin:21-jdk

# Installer Maven manuellement pour Ãªtre sÃ»r
ARG MAVEN_VERSION=3.9.6
RUN apt-get update && \
    apt-get install -y curl && \
    curl -fsSL https://archive.apache.org/dist/maven/maven-3/${MAVEN_VERSION}/binaries/apache-maven-${MAVEN_VERSION}-bin.tar.gz \
    | tar xzf - -C /opt && \
    ln -s /opt/apache-maven-${MAVEN_VERSION} /opt/maven && \
    rm -rf /var/lib/apt/lists/*

# Variables d'environnement Maven
ENV M2_HOME=/opt/maven
ENV MAVEN_HOME=/opt/maven
ENV PATH=${M2_HOME}/bin:${PATH}

WORKDIR /app

# âœ… VÃ©rification des versions (cette fois Ã§a sera Java 21)
RUN echo "ðŸ”§ Versions installÃ©es:" && \
    java --version && \
    echo "" && \
    mvn --version

# Copier pom.xml et installer les dÃ©pendances
COPY pom.xml .
RUN mvn dependency:go-offline -B

# Copier tout le code
COPY . .

# Commande de test
CMD ["mvn", "test", "-Dmaven.test.failure.ignore=false"]